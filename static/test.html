<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Datatables test</title>
        <div id="my-mirador" style="height: 100%; width:100%; margin:auto; position: relative">

        <script src="https://unpkg.com/mirador@latest/dist/mirador.min.js"></script>

        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.css" />
        <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.js"></script>

    </head>
    <body>
        <h1>Datatables test</h1>
        <h2>New test:</h2>
        <table id="content" class="table table-striped table-bordered" style="width:100%" data-server-side="true" data-ajax="/api/content/?format=datatables">
            <thead>
                <tr>
                  <th data-data="manuscript">Manuscript</th>
                  <th data-data="formula">Formula</th>
                  <th data-data="formula_text">formula_text</th>
                  <th data-data="rite_name_from_ms">rite_name_from_ms</th>
                  <th data-data="sequence_in_ms">sequence_in_ms</th>
                  <th data-data="where_in_ms_from">where_in_ms_from</th>
                  <th data-data="where_in_ms_to">where_in_ms_to</th>
                </tr>
              </thead>
        </table>
        <script>
            $(document).ready(function() {
                $('#content').DataTable();
            
            
            
            
                            var mirador = Mirador.viewer({
                            "id": "my-mirador",
                            "manifests": {
                                "https://collections.library.yale.edu/manifests/2010330": {
                                "provider": "external"
                                }
                            },
                            "windows": [
                                {
                                "loadedManifest": "https://collections.library.yale.edu/manifests/2010330",
                                "canvasIndex": 2,
                                "thumbnailNavigationPosition": 'far-bottom'
                                }
                            ]
                            });
            
            
            
            
                            /*

        iiif_manifest_url = "https://collections.library.yale.edu/manifests/2010330";
        manifests = {}
        manifests[iiif_manifest_url]={"provider": "external"}

        mirador_config = {
            "id": "my-mirador",
            "manifests": manifests,
            "windows": [
                {
                "loadedManifest": iiif_manifest_url,
                "canvasIndex": 2,
                "thumbnailNavigationPosition": 'far-bottom'
                }
            ]
        };
        console.log(mirador_config);

            */
            
            });












        </script>
        <!--
        <h2> old test:</h2>
        <table id="myTable" class="display" style="width:100%">
        </table>
        <script>
            $(document).ready(function () {
                let pk = 2;  // Replace with the actual value


                new DataTable('#myTable', {
                    ajax: '/ms_content/' + pk + '/',
                    processing: true,
                    serverSide: true,
                    columns: [
                        {name: "formula", title: "formula", data: 0},
                        {name: "rite", title: "rite", data: 1},
                    ]
                });
                /*
                // Make the AJAX request to get the data
                $.ajax({
                    url: '/ms_content/' + pk + '/',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        // Assuming 'headers' and 'rows' are keys in your JSON response
                        let headers = data.headers;
                        let rows = data.data;
        
                        // Initialize DataTable with the received data
                        let table = $('#myTable').DataTable({
                            data: data,
                            columns: headers.map(function (header) {
                                return { name: header, title: header, data: header };
                            }),
                        });
        
                        // Add input fields for column filtering
                        table.columns().eq(0).each(function (colIdx) {
                            $('div#column_filter').append('<input type="text" class="column_search" data-column="' + colIdx + '" placeholder="' + headers[colIdx] + '" />');
                        });
        
                        // Apply column filtering
                        $('input', 'div#column_filter').on('input', function () {
                            let columnIdx = $(this).data('column');
                            table.column(columnIdx).search(this.value).draw();
                        });
        
                        // Initialize DataTable pagination
                        $('#myTable').DataTable().clear().rows.add(data.rows).draw();
                    },
                    error: function (error) {
                        console.error('Error fetching data:', error);
                    }
                });*/
            });
        </script>
        -->
        
        
    </body>
</html>